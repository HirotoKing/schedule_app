<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>スケジュールアプリ</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <!-- 雲コンテナ -->
  <div class="top">
    <div id="cloudContainer"></div>

    <!-- 上部メニュー -->
    <div class="top-bar">
      <button id="historyBtn">移動履歴</button>
    </div>

    <!-- 気球と高度 -->
    <img src="{{ url_for('static', filename='balloon.png') }}" class="balloon" id="balloon" alt="気球" />
    <div class="altimeter" id="altimeter" data-altitude="100">高度：100m</div>
    <div id="warning" class="warning"></div>
  </div>

  <!-- 下部メイン -->
  <div class="bottom">
    <div id="question" class="question">読み込み中...</div>
    <div class="button-grid">
      <button onclick="handleButtonClick('寝食')">寝食</button>
      <button onclick="handleButtonClick('仕事')">仕事</button>
      <button onclick="handleButtonClick('知的活動')">知的活動</button>
      <button onclick="handleButtonClick('勉強')">勉強</button>
      <button onclick="handleButtonClick('運動')">運動</button>
      <button onclick="handleButtonClick('ゲーム')">ゲーム</button>
    </div>
    <div id="todayDate" class="today-date"></div>
  </div>

  <!-- ボーナス質問ポップアップ -->
  <div id="bonusPopup" class="popup hidden">
    <div class="popup-content">
      <h3>初回ログインボーナス🎁</h3>
      <p>以下の質問に答えてください（正直に！）</p>
      <div>
        <label><input type="checkbox" id="q1"> 昨日のスマホ操作時間は6時間以下だった</label>
      </div>
      <div>
        <label><input type="checkbox" id="q2"> 昨日は24:00より前に寝て、今日は7:00に起きた</label>
      </div>
      <button id="bonusSubmit">回答してスタート</button>
    </div>
  </div>

  <!-- 移動履歴ポップアップ -->
  <div id="historyPopup" class="popup hidden">
    <div class="popup-content">
      <span id="closePopup" class="close-btn">×</span>
      <h3>今までの高度推移</h3>
      <canvas id="heightChart" width="300" height="150"></canvas>
      <h4>活動回数の合計</h4>
      <ul id="summaryList"></ul>
    </div>
  </div>

  <!-- スクリプト読み込み -->
  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script>
    const today = new Date().toISOString().split('T')[0];
    startQuestioning(today);
    initClouds();
    maintainClouds();
  </script>
</body>
</html>
